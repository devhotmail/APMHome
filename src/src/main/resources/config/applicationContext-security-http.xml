<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
            xmlns:p="http://www.springframework.org/schema/p"
             xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <!-- public pages -->
    <http pattern="/login.xhtml" security="none" />
    <http pattern="/web/*" security="none" />
    <http pattern="/restful/*" security="none" />
    <http pattern="/ws/*" security="none" />
    <http pattern="/soap/*" security="none" />
    <http pattern="/favicon.ico" security="none" />
    <http pattern="/resources/*" security="none" />
    <http pattern="/javax.*/**" security="none" />
    <http pattern="/login.faces*" security="none" />
    <http pattern="/error/*" security="none" />
	
    <beans:bean name="logoutHandler" class="com.ge.apm.view.sysutil.LogoutHandler" 
                p:logoutSuccessUrl="/login.xhtml"/>
    
    <!-- secure pages -->
    <http auto-config="true" use-expressions="true">
        <form-login login-page="/login.xhtml" default-target-url="/home.xhtml" login-processing-url="/logincheck" always-use-default-target="true" authentication-failure-url="/login?login_error=1"/>
        <logout logout-url="/logout.xhtml" success-handler-ref="logoutHandler"/>

        <intercept-url pattern="/home.xhtml" access="isAuthenticated()"/>
        <intercept-url pattern="/portal/**" access="isAuthenticated()"/>
        <intercept-url pattern="/sysadmin/**" access="hasRole('SuperAdmin')"/>
        <intercept-url pattern="/admin/**" access="hasRole('SuperAdmin')" />
        <intercept-url pattern="/layout/**" access="hasRole('ADMIN')"/>
        <intercept-url pattern="/**/*.xhtml*" access="isAuthenticated()"/>

        <access-denied-handler error-page="/accessdenied.xhtml" />
        <!--
        <port-mappings>
            <port-mapping http="80" https="443"/>
            <port-mapping http="8080" https="443"/>
        </port-mappings>
        -->
    </http>
</beans:beans>

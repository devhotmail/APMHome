<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/layout/template.xhtml">

        <ui:define name="title">
            <h:outputText value="#{msg.SQLTestControllerTitle}"/>
        </ui:define>

        <ui:define name="body">
            <b>Search Conditions:</b>

            <h:form id="searchForm">
                <h:panelGrid id="searchPanel" columns="10">
                    <p:outputLabel value="#{msg.ExamStatus}"/>
                    <p:selectOneMenu id="search_EQ_e-exam_status">
                        <f:selectItem itemLabel="全部" itemValue="" />
                        <f:selectItem itemLabel="1" itemValue="1" />
                        <f:selectItem itemLabel="2" itemValue="2" />
                        <f:selectItem itemLabel="3" itemValue="3" />
                        <f:selectItem itemLabel="4" itemValue="4" />
                        <f:selectItem itemLabel="5" itemValue="5" />
                        <f:selectItem itemLabel="6" itemValue="6" />
                    </p:selectOneMenu>
                    <p:outputLabel value="#{msg.ExamID}"/>
                    <p:inputText id="search_GTE_e-exam_id" placeholder="ExamID>=?"/>
                    
                    <p:commandButton value="Search" actionListener="#{sqlDynaColumnController.setSearchFilter()}" update="listForm:datalist"/>
                    <p:commandButton value="#{msg.resetInput}" update="searchPanel" process="@this">
                        <p:resetInput target="searchPanel"/>
                    </p:commandButton>                        
                </h:panelGrid>
                
            </h:form>

            <h:form id="listForm">
                <p:dataTable id="datalist" value="#{sqlDynaColumnController.lazyModel}" var="item" widgetVar="varDataList"
                             selectionMode="single" selection="#{sqlDynaColumnController.selected}"
                             lazy="true" paginator="true" paginatorPosition="bottom" paginatorAlwaysVisible="true"
                             rowKey="#{item.hashCode()}" sortMode="single" sortOrder="descending"
                             paginatorTemplate="{CurrentPageReport} {Toolbar} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} &nbsp;&nbsp;&nbsp;&nbsp; #{msg.RowsPerPage}: {RowsPerPageDropdown}"
                             currentPageReportTemplate="#{msg.recordCount}: {totalRecords}"
                             rows="5" emptyMessage="#{msg.noRecordFound}"
                             rowsPerPageTemplate="20,40,60,90">

                    <p:ajax event="rowSelect" listener="#{sqlDynaColumnController.onRowSelected}"/>

                    <f:facet name="header">
                        <p:commandButton rendered="false" id="toggler" value="Columns" style="float:right;top: -5px;height: 25px;" icon="ui-icon-calculator"/>
                        <p:columnToggler datasource="datalist" trigger="toggler" rendered="false">
                            <p:ajax event="toggle" listener="#{sqlDynaColumnController.onToggleColumn}" />
                        </p:columnToggler>
                    </f:facet>

                    <p:columns value="#{sqlDynaColumnController.fieldList}" var="column" columnIndexVar="colIndex" sortBy="#{item[column.fieldName]}" visible="#{column.isVisible}">
                        <f:facet name="header">
                            <h:outputText value="#{column.headerName}" />
                        </f:facet>
                        <h:outputText value="#{sqlDynaColumnController.getFieldValue(item, column.fieldName)}"/>
                    </p:columns>
                    <f:facet name="{Toolbar}">
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <p:commandButton value="#{msg.exportToXLS}" icon="ui-icon-arrowstop-1-s" ajax="false">
                            <p:dataExporter type="xls" target="datalist" fileName="xls_export"/>
                        </p:commandButton>
                        &nbsp;&nbsp;
                    </f:facet>
                </p:dataTable>
            </h:form>
        </ui:define>
    </ui:composition>
</html>

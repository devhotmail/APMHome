<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
        <f:facet name="first">
            <meta charset="UTF-8"/>
            <meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;"/>
            <meta name="apple-mobile-web-app-capable" content="yes" />
        </f:facet>
        <title>#{msg.AssetInfo}</title>
        <h:outputStylesheet name="wechat/css/weui.min.css" />
        <script type="text/javascript" src="#{wechatUtilService.getContextPath()}/resources/wechat/js/utils/jquery-3.1.1.min.js"/>
        <script type="text/javascript" src="#{wechatUtilService.getContextPath()}/resources/wechat/js/utils/jweixin-1.0.0.js"/>
    </h:head>
    <body>
        <div class="page__bd">

            <h:form id="assetList" >
                <div class="weui-search-bar" id="searchBar">
                    <div class="weui-search-bar__form">
                        <div class="weui-search-bar__box ">
                            <i class="weui-icon-search"></i>
                            <h:inputText  class="weui-search-bar__input" id="searchInput" value="#{wxAssetInfoController.searchStr}"   onchange="search()"/>
                            <a href="javascript:clear()" class="weui-icon-clear" id="searchClear"></a>
                        </div>
                    </div>

                </div>
                    <div class="weui-cell weui-cell_select weui-cell_select-after">
                            <div class="weui-cell__hd">
                                <label for="assetGroup" class="weui-label">#{msg.assetGroup}</label>
                            </div>
                            <div class="weui-cell__bd">
                                <h:selectOneMenu id="assetGroup" class="weui-select" value="#{wxAssetInfoController.searchGroup}" onchange="search()">
                                    <f:selectItem itemLabel="全部"/>
                                    <f:selectItems value="#{fieldMsg.getFieldValueList('assetGroup')}" var="item" itemLabel="#{item.value}" itemValue="#{item.msgKey}"/>
                                </h:selectOneMenu>
                            </div>
                    </div>
                    <div class="weui-cell weui-cell_select weui-cell_select-after">
                        <div class="weui-cell__hd">
                            <label for="clinicalDeptId" class="weui-label">#{msg.clinicalDeptId}</label>
                        </div>
                        <div class="weui-cell__bd">
                            <h:selectOneMenu id="clinicalDeptId" class="weui-select" value="#{wxAssetInfoController.searchDept}" onchange="search()">
                                <f:selectItem itemLabel="全部"/>
                                <f:selectItems value="#{wxAssetInfoController.getSearchDeptList()}" var="item" itemLabel="#{item[0]}" itemValue="#{item[1]}"/>
                            </h:selectOneMenu>
                        </div>
                    </div>
                <div class="weui-cell weui-cells_checkbox">
                    <div class="weui-cell__bd">
                        状态
                    </div>
                    <div class="weui-cell__bd">
                        <h:selectBooleanCheckbox id="running"  class="weui-check" value="#{wxAssetInfoController.searchStatRun}" onchange="search()"/>
                        <i class="weui-icon-checked"></i>
                        <label class="weui-check__label" for="assetList:running" style="">正常</label>
                    </div>
                    <div class="weui-cell__bd">
                        <h:selectBooleanCheckbox id="stoped" class="weui-check" value="#{wxAssetInfoController.searchStatStop}" onchange="search()"/>
                        <i class="weui-icon-checked"></i>
                        <label class="weui-check__label" for="assetList:stoped">停机</label>
                    </div>
                    <div class="weui-cell__bd">
                        <h:selectBooleanCheckbox id="partial" class="weui-check" value="#{wxAssetInfoController.searchStatPartial}" onchange="search()"/>
                        <i class="weui-icon-checked"></i>
                        <label class="weui-check__label" for="assetList:partial">异常</label>
                    </div>
                </div>
                <p:remoteCommand name="search" actionListener="#{wxAssetInfoController.onSearch}" update="dataList" />
            </h:form>

        </div>
        <p:dataScroller id="dataList" value="#{wxAssetInfoController.getAssetList()}" var="asset" chunkSize="10"  rowIndexVar="row"  >
            <f:facet name="header">
                <div >
                    总计： #{wxAssetInfoController.getAssetList().size()}
                </div>
            </f:facet>
            <h:link  outcome="Detail.xhtml" class="weui-media-box weui-media-box_appmsg">
                <f:param name="assetId" value="#{asset.id}"/>
                <f:param name="action" value="view"/>
                <!--<f:param name="qrCode" value="#{wxAssetInfoController.qrCode}" disable="#{empty wxAssetInfoController.qrCode}"/>-->
                <!--<div class="weui-media-box__hd">
                    <img id="icoassetGroup" class="weui-media-box__thumb icoassetGroup" src="#{wechatUtilService.getContextPath()}/resources/wechat/icons/assetgroup#{asset.assetGroup}.ico" />
                </div>-->
                <div class="weui-media-box__bd">
                    <h4 class="weui-media-box__title">#{asset.name}</h4>
                    <p class="weui-media-box__desc">设备类型：#{fieldMsg.fieldValue('assetGroup',asset.assetGroup)}  
                        <h:outputText value="制造厂商：#{asset.manufacture}" rendered="#{not empty asset.manufacture}" style="margin-left: 5px"/></p>
                    <p class="weui-media-box__desc">
                        <h:outputText value="使用科室：#{asset.clinicalDeptName}" rendered="#{not empty asset.clinicalDeptName}"/>
                        <h:outputText value="负责人:" rendered="#{not empty asset.assetOwnerName or not empty asset.assetOwnerName2}" style="margin-left: 5px"/>
                        <h:outputText value="#{asset.assetOwnerName}" rendered="#{not empty asset.assetOwnerName}" style="margin-left: 5px"/>
                        <h:outputText value="," rendered="#{not empty asset.assetOwnerName and not empty asset.assetOwnerName2}" style="margin-left: 5px"/>
                        <h:outputText value="#{asset.assetOwnerName2}" rendered="#{not empty asset.assetOwnerName2}"/>
                     </p>
                </div>
                <div class="weui-media-box__ft">
                    <p  style="height: 60px">#{asset.status==1?"运行":""}#{asset.status==2?"停机":""}#{asset.status==3?"异常":""}</p>
                </div>
            </h:link>
            <p:separator ></p:separator>
        </p:dataScroller>

    </body>
    <script type="text/javascript">
        $("#assetList\\:searchInput").attr('placeholder', '搜索...');


        function clear() {
            $("#assetList\\:searchInput").val('');
            search();
        }
        
        $(".weui-icon-checked").on("click",function(){
            $(this).parents().children(".weui-check").click();
        });

    </script>
</html>

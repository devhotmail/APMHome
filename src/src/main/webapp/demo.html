<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
    <head>
        <title>
            display/box/float/clear test
        </title>
        <style type="text/css">
            /* last modified: 1 Dec 98 */

            html {
                font: 10px/1 Verdana, sans-serif;
                background-color: blue;
                color: white;
            }

            body {
                margin: 1.5em;
                border: .5em solid black;
                padding: 0;
                width: 60em;
                background-color: white;
            }

            dl {
                margin: 0;
                border: 0;
                padding: .5em;
            }

            dt {
                background-color: rgb(204,0,0);
                margin: 0;
                padding: 1em;
                width: 10.638%; /* refers to parent element's width of 47em. = 5em or 50px */
                height: 28em;
                border: .5em solid black;
                float: left;
            }

            dd {
                float: right;
                margin: 0 0 0 1em;
                border: 1em solid black;
                padding: 1em;
                width: 34em;
                height: 27em;
            }

            ul {
                margin: 0;
                border: 0;
                padding: 0;
            }

            li {
                display: block; /* i.e., suppress marker */
                color: black;
                height: 9em;
                width: 5em;
                margin: 0;
                border: .5em solid black;
                padding: 1em;
                float: left;
                background-color: #FC0;
            }

            #bar {
                background-color: black;
                color: white;
                width: 41.17%; /* = 14em */
                border: 0;
                margin: 0 1em;
            }

            #baz {
                margin: 1em 0;
                border: 0;
                padding: 1em;
                width: 10em;
                height: 10em;
                background-color: black;
                color: white;
            }

            form {
                margin: 0;
                display: inline;
            }

            p {
                margin: 0;
            }

            form p {
                line-height: 1.9;
            }

            blockquote {
                margin: 1em 1em 1em 2em;
                border-width: 1em 1.5em 2em .5em;
                border-style: solid;
                border-color: black;
                padding: 1em 0;
                width: 5em;
                height: 9em;
                float: left;
                background-color: #FC0;
                color: black;
            }

            address {
                font-style: normal;
            }

            h1 {
                background-color: black;
                color: white;
                float: left;
                margin: 1em 0;
                border: 0;
                padding: 1em;
                width: 10em;
                height: 10em;
                font-weight: normal;
                font-size: 1em;
            }
        </style>
    </head>
    <body>
        <div id="yuki">
            <h2>Report Region Demo</h2>
            <div style="width:650px;border:1px darkgray solid;display:block;padding:50px;background-color: chocolate;">
                <table>
                    <captian>CT Report </captian>
                    <tr>
                        <td colspan="3" style="border:1px darkgray solid;">
                            <table cellspacing="10">
                                <tr style="margin: 25px;padding: 25px">
                                    <td>Name:</td>
                                    <td>demo</td>
                                    <td>Sex:</td>
                                    <td>man</td>
                                    <td>Age:</td>
                                    <td>22</td>
                                    <td>ExamDate:</td>
                                    <td>2016-6-23</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td>clinical Diagnosis:</td>
                        <td colspan="2"><input type="text" style="width:410px"></td>
                    </tr>
                    <tr>
                        <td>exam Method:</td>
                        <td colspan="2"><input type="text" style="width:410px"></td>
                    </tr>
                    <tr>
                        <td colspan="3">mainfestation:</td>
                    </tr>
                    <tr>
                        <td colspan="3"><textarea name="" id="" cols="78" rows="10"></textarea></td>
                    </tr>
                    <tr>
                        <td colspan="3">impression:</td>
                    </tr>
                    <tr>
                        <td colspan="3"><textarea name="" id="" cols="78" rows="2"></textarea></td>
                    </tr>
                </table>
            </div>
        </div>
        <script type="text/javascript" src="resources/js/html2canvas.min.js"></script>
        <script type="text/javascript">
            html2canvas(document.getElementById("yuki"), {
                onrendered: function (canvas) {
                    canvas.id = "mycanvas";
                    console.log(canvas);
                    var dataUrl = canvas.toDataURL("image/png");
                    var formData = new FormData(); //模拟表单对象
                    formData.append("imgData", convertBase64UrlToBlob(dataUrl)); //写入数据
                    var xhr = new XMLHttpRequest(); //数据传输方法
                    xhr.open("POST", "/geris/web/exportPdf"); //配置传输方式及地址
                    xhr.send(formData);
                    xhr.onreadystatechange = function () { //回调函数
                        if (xhr.readyState == 4) {
                            if (xhr.status == 200) {
                                var back = JSON.parse(xhr.responseText);
                                if (back.success == true) {
                                    alertBox({content: 'Pdf导出成功！', lock: true, drag: false, ok: true});
                                } else {
                                    alertBox({content: 'Pdf导出失败！', lock: true, drag: false, ok: true});
                                }
                            }
                        }
                    };
                }
            });
            function convertBase64UrlToBlob(urlData) {
                //去掉url的头，并转换为byte
                var bytes = window.atob(urlData.split(',')[1]);
                //处理异常,将ascii码小于0的转换为大于0
                var ab = new ArrayBuffer(bytes.length);
                var ia = new Uint8Array(ab);
                for (var i = 0; i < bytes.length; i++) {
                    ia[i] = bytes.charCodeAt(i);
                }
                return new Blob([ab], {type: 'image/png'});
            }
        </script>
    </body>
</html>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template.xhtml">

    <ui:define name="content">
                <h:form id="checkListQueryForm">
                <p align="center" id="title">
                    <b>#{msg.checkListSetting}</b>
                </p>
            <div class="ui-g ui-fluid">
                <div class="ui-g-12 ui-lg-4">
                    <div class="card" style="height:400px;">

                        <p:scrollPanel style="width:98%;height:95%;border: 0" mode="native" >
                            <label class="label">#{msg.searchAssetByDept} #{msg.ChecklistType}</label>
                            <p:tree id="assetTree" class="tree" style="border:0;" value="#{inspectionChecklistController.orgAssetTree}" var="node" dynamic="false" cache="false" selectionMode="single" selection="#{inspectionChecklistController.selectedNode}" highlight="true">
                                <p:ajax event="select" listener="#{inspectionChecklistController.onSelectTreeNode}" update=":checkListQueryForm :checkListQueryForm:datalist"/>
                                <p:ajax event="expand" listener="#{inspectionChecklistController.onExpandTreeNode}" />
                                <p:ajax event="collapse" listener="#{inspectionChecklistController.onCollapseTreeNode}" />

                                <p:treeNode type="org">
                                    <h:outputText value="#{node.name}"/>
                                </p:treeNode>
                                <p:treeNode type="asset" icon="ui-icon-wifi-tethering">
                                    <h:outputText value="#{node.name}"/>
                                </p:treeNode>
                                <p:treeNode type="checklist">
                                    <h:outputText value="#{node[1]}"/>
                                </p:treeNode>
                            </p:tree>
                        </p:scrollPanel>
                    </div>
                </div>

                <div class="ui-g-12 ui-lg-8">
                    <div class="card" style="height:400px;">

                            <p:dataTable id="datalist" value="#{inspectionChecklistController.checklistitemList}" var="item" widgetVar="varDataList" 
                                         selectionMode="single" selection="#{inspectionChecklistController.selected}"
                                         paginator="true" paginatorPosition="top" paginatorAlwaysVisible="true" style="height:95%;"
                                         rowKey="#{item.id}" sortMode="single"  sortOrder="ascending" sortBy="#{item.displayOrder}"
                                         paginatorTemplate="{Toolbar} {CurrentPageReport}" rowIndexVar="rowIndex" emptyMessage="#{msg.noRecordFound}"
                                         currentPageReportTemplate="#{msg.recordCount}: {totalRecords}" draggableRows="true" scrollable="true">

                                <p:ajax event="rowSelect" update="createButton editButton deleteButton"/>
                                <p:ajax event="rowReorder" listener="#{inspectionChecklistController.onRowReorder}" update="saveOrder"/>

                                <p:column headerText="#{fieldMsg.fieldValue('checklistType', inspectionChecklistController.checklistType)} #{msg.checkListSetting}">
                                    <h:outputText value="#{item.item}" />
                                </p:column>
                                <f:facet name="{Toolbar}">
                                    <p:commandButton title="#{msg.exportToXLS}" icon="ui-icon-file-download" class="btn btn-sm btn-gray" ajax="false">
                                        <p:dataExporter type="xls" target="datalist" fileName="InspectionChecklist_export"/>
                                    </p:commandButton>
                                    <p:commandButton id="createButton" icon="ui-icon-plus" class="btn btn-sm btn-gray" title="#{msg.Create}" actionListener="#{inspectionChecklistController.prepareCreate}" update=":InspectionChecklistEditDlg" oncomplete="PF('InspectionChecklistEditDialog').show()" disabled="#{0 == inspectionChecklistController.checklistType}"/>
                                    <p:commandButton id="editButton" icon="ui-icon-pencil" class="btn btn-sm btn-gray" title="#{msg.Edit}" actionListener="#{inspectionChecklistController.prepareEdit}" update=":InspectionChecklistEditDlg" oncomplete="PF('InspectionChecklistEditDialog').show()" disabled="#{empty inspectionChecklistController.selected}"/>
                                    <p:commandButton id="deleteButton" icon="ui-icon-trash" class="btn btn-sm btn-gray" title="#{msg.Delete}" actionListener="#{inspectionChecklistController.prepareDelete}" update=":InspectionChecklistViewDlg" oncomplete="PF('InspectionChecklistViewDialog').show()" disabled="#{empty inspectionChecklistController.selected}"/>
                                    <p:commandButton id="saveOrder" icon="ui-icon-save" class="btn btn-sm btn-gray" title="#{msg.saveOrder}" actionListener="#{inspectionChecklistController.saveOrder}"  update="saveOrder datalist" disabled="#{not inspectionChecklistController.isOrderChange}"/>
                                </f:facet>
                            </p:dataTable>

                    </div>
                </div>
            </div>
            </h:form>
                <ui:include src="checkListEdit.xhtml"/>
                <ui:include src="checkListView.xhtml"/>

        <ui:include src="/portal/asset/selectAssetDialog.xhtml"/>
    </ui:define>
</ui:composition>